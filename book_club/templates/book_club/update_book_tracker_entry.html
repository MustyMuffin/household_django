{% extends "household_main/base.html" %}
{% load widget_tweaks %}
{% block content %}
<div class="container mt-4">
  <div class="card">
    <div class="card-header">
      <h4>üìù Update Progress for {{ book }}</h4>
    </div>
    <div class="card-body">
      <form method="post">
        {% csrf_token %}
        <div class="mb-3">
          <label for="{{ form.notes.id_for_label }}" class="form-label">Notes</label>
          {{ form.text|add_class:"form-control" }}
        </div>
        <div class="mb-3">
          <label for="wordSlider" class="form-label">Words Completed</label>
            <div class="mb-3">

              <input
                type="range"
                class="form-range"
                id="wordSlider"
                name="slider"
                min="0"
                max="{{ book.words }}"
                value="{{ form.words_completed.value|default_if_none:0 }}"
                step="1"
              >

              <small class="text-muted">Words: <span id="sliderValue">{{ form.words_completed.value|default_if_none:0 }}</span></small>

              {{ form.words_completed|add_class:"d-none"|attr:"id:id_words_completed" }}
            </div>

        </div>
        <button type="submit" class="btn btn-primary">üïÆ Update</button>
      </form>
    </div>
  </div>
</div>

    <div class="container mt-3">
            <form action="{% url 'book_club:new_book_entry' book.id %}" method='post'>
                {% csrf_token %}
                <button name='submit' class="btn btn-sm btn-block btn-outline-primary">Completed?</button>
            </form>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const slider = document.getElementById("wordSlider");
        const hiddenInput = document.getElementById("id_words_completed");
        const sliderValue = document.getElementById("sliderValue");

        if (slider && hiddenInput && sliderValue) {
          hiddenInput.value = slider.value;
          sliderValue.textContent = slider.value;

          slider.addEventListener("input", function () {
            hiddenInput.value = this.value;
            sliderValue.textContent = this.value;
          });
        }
      });
    </script>
{% endblock %}
